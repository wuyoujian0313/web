/*!
 * datefield component
 * http://www.wadecn.com/
 * auth:xiedx@asiainfo.com
 * Copyright 2015, WADE
 */
!function(c,i,p){"use strict";if(c&&"undefined"==typeof c.DateField){Array.prototype.push,Array.prototype.splice;var e=p.createElement("input"),t="oninput"in e;e=null;var l,s,n="undefined"!=typeof c.hasTouch?c.hasTouch:"ontouchstart"in i,d=n?"touchstart":"mousedown",r=c.os.phone||!0===c.ratioPhone,u="_Wade_DropDownCalendar",f=function(e,t){var n=this;n.el=e&&1==e.nodeType?e:p.getElementById(e),n.el&&n.el.nodeType&&(n.id=c.attr(n.el,"id"))&&(t&&c.isObject(t)&&c.extend(n,t),c.attr(n.el,"x-wade-uicomponent")||c.attr(n.el,"x-wade-uicomponent","datefield"),n._init(),n.constructor.call(n))};f.prototype=c.extend(new c.UIComponent,{val:function(e){var t=this;if(e==undefined)return t.el.value;t.value=t.el.value=e},refresh:function(){var e=this;e.spanEl||(e.spanEl=c(e.el).parents("span.e_group:first")[0]);var t=e.spanEl.getBoundingClientRect();e.spanLeft=t.left,e.spanTop=t.top,e.spanHeight=e.spanEl.offsetHeight,e.spanWidth=e.spanEl.offsetWidth;var n=e.spanTop,a=(e.spanLeft,p.body),o=a.offsetHeight-e.spanHeight-n;c.isNumber(a.scrollTop)&&(e.spanTop+=a.scrollTop-2),c.isNumber(a.scrollLeft)&&(e.spanLeft+=a.scrollLeft),e.dir=n<=o?"down":"up";var i="down"==e.dir?o:n,l=0,s=0,d=p.getElementById(u+"_float");(" "+(d.className?d.className:"")+" ").indexOf(" c_float-show ")<0?(d.style.left="-99999px",d.style.top="-99999px",d.style.display="block",l=d.offsetWidth,s=d.offsetHeight,d.style.display=""):(l=d.offsetWidth,s=d.offsetHeight);var r=Math.min(i,s),f=document.documentElement.clientHeight;d.style.left=e.spanLeft+e.spanWidth-l+"px",d.style.top=s<=f&&n<s&&o<s?(f-s)/2+"px":("down"==e.dir?e.spanTop+e.spanHeight:e.spanTop-r)+"px"},getDisabled:function(){return this.disabled},setDisabled:function(e){var n=this;void 0!==e&&(n.disabled=!!e,n.el.disabled=n.disabled,setTimeout(function(){var e=n.spanEl?n.spanEl:n.el,t=e.className?e.className:"";n.disabled?(" "+t+" ").indexOf(" e_dis ")<0&&(e.className=c.trim(t+" e_dis")):(t=c.trim((" "+t+" ").replace(/ e_dis /gi," ")),e.className=t)},0))},getReadonly:function(){return this.readonly},setReadonly:function(e){var t=this;void 0!==e&&(t.readonly=!!e,setTimeout(function(){c.attr(t.el,"readonly",t.readonly)},0))},destroy:function(){var e=this;e.spanEl=null,e.icoEl=null,e.el=null},_init:function(){var o=this;if(o.spanEl=c(o.el).parents("span.e_group:first")[0],o.icoEl=o.spanEl?c(o.spanEl).find("span.e_ico-date:first")[0]:null,o.icoEl&&(o.icoEl.style.display=o.dropDown?"":"none"),(r||c.os.pad||o.readonly)&&o.setReadonly(!0),o.disabled&&o.setDisabled(!0),t?c(o.el).bind("input",function(e){this.value=(""+this.value).replace(/[^0-9-\/\s:]+/gi,"")}):c(o.el).keydown(function(e){return!(e.shiftKey||e.altKey||e.ctrlKey)&&(47<e.keyCode&&e.keyCode<58||95<e.keyCode&&e.keyCode<106||8==e.keyCode||46==e.keyCode||189==e.keyCode||191==e.keyCode)}),!0===o.dropDown){var e=function(e){if(!o.disabled&&!0===o.dropDown){e.originalEvent&&(e=e.originalEvent),function a(){return l||(c(p.body).append('<div id="'+u+'_float" class="c_float'+(r?" c_float-phone-auto":"")+'" style="width:22em;"><div  id="'+u+'_float_bg" class="bg"></div><div  id="'+u+'_float_content" class="content"></div></div>'),l=c.Calendar.append(u+"_float_content",{name:u,className:"c_calendar"+(r?"":" c_calendar-s")}),c("#"+u).select(function(e){s&&i[s]&&i[s]instanceof f&&!0!==i[s].useTime&&!0===i[s].dropDown&&(i[s].val(this.val()),c.event.trigger("afterAction",null,i[s].el),y())}),c("#"+u).clear(function(e){s&&i[s]&&i[s]instanceof f&&!0===i[s].dropDown&&(i[s].val(""),c.event.trigger("afterAction",null,i[s].el)),y()}),c("#"+u).ok(function(e){if(s&&i[s]&&i[s]instanceof f&&!0===i[s].useTime&&!0===i[s].dropDown)return i[s].val(this.val()),c.event.trigger("afterAction",null,i[s].el),y(),!1}),c("#"+u+"_float_bg").bind(d,function(){y()}),l)}(),l&&(c.extend(l,{now:o.now,format:o.format,value:o.value,useTime:o.useTime}),l.reset()),o.refresh();var t=p.getElementById(u+"_float"),n=t.className?t.className:"";(" "+n+" ").indexOf(" c_float-show ")<0&&(t.className=c.trim(n+" c_float-show")),s=o.id}};c(o.el).bind("tap",e),c(o.icoEl).bind("tap",e)}}}),c(function(){c(p.body).bind(d,function(e){if(e&&e.target){var t=e.target;if(t&&t.nodeType&&l){for(var n=0,a=!1;t&&t.nodeType&&t!=p.body&&n<50;){var o=c.attr(t,"id");if(o&&c.isString(o)&&(0==o.indexOf(s)||0==o.indexOf(u))){a=!0;break}t=t.parentNode,n++}a||y()}}}),c(i).bind("onorientationchange"in i?"orientationchange":"resize",function(){y()}),n||c(p.body).bind("mousewheel",function(e){y()})}),i.DateField=c.DateField=f}function y(){if(s){var e=p.getElementById(u+"_float");if(null!=e&&1==e.nodeType){var t=e.className?e.className:"";-1<(" "+t+" ").indexOf(" c_float-show ")&&(e.className=c.trim((" "+t+" ").replace(/ c_float-show /gi," ")))}s=e=null}}}(window.Wade,window,document);