/*!
 * dialog component
 * http://www.wadecn.com/
 * auth:xiedx@asiainfo.com
 * Copyright 2015, WADE
 */
!function(h,o,g){"use strict";if(h&&"undefined"==typeof h.Dialog){var i=Array.prototype.push,e=Array.prototype.splice,t=h.os.phone||!0===h.ratioPhone,n=[],r=function(t,e){var i=this;i.el=t&&1==t.nodeType?t:g.getElementById(t),i.el&&i.el.nodeType&&(i.id=h.attr(i.el,"id"))&&(e&&h.isObject(e)&&h.extend(i,e),h.attr(i.el,"x-wade-uicomponent")||h.attr(i.el,"x-wade-uicomponent","dialog"),i._init(),i.constructor.call(i))};if(r.prototype=h.extend(new h.UIComponent,{show:function(t){var e=this;e.el.style.zIndex=h.zIndexer.get(e.id),e.el.style.display="",e.visible=!0,u(e.content,e.id),c(e.content),f(e.content),i.call(n,e.id)},hide:function(){var t=this;!1!==t.visible&&!1!==h.event.trigger("hideAction",null,t.el)&&(h.zIndexer.remove(t.id),t.el.style.display="none",t.visible=!1,e.call(n,h.inArray(t.id,n),1))},dragStart:function(t,e,i){var n=this;if(!t||!t.nodeType||!h.nodeName(t,"div"))return!1;for(var o=0,r=t,a=!1,l=!1;o<6&&r;){if(r.nodeType&&r.parentNode&&r.parentNode.nodeType&&("text"==r.className&&(a=!0),h.nodeName(r.parentNode,"div")&&n.id==h.attr(r.parentNode,"id"))){l=!0;break}r=r.parentNode,o++}if(!l||!a)return!1;g.body.offsetWidth,g.body.offsetHeight;var d=n.wrapper.offsetWidth,s=n.wrapper.offsetHeight,p=n.wrapper.offsetLeft,u=n.wrapper.offsetTop,c=e-p,f=i-u;return!(c<=0||f<=0)&&(n.dragContentWidth=d,n.dragContentHeight=s,n.dragDistX=c,n.dragDistY=f,"absolute"!=n.wrapper.style.position&&(n.wrapper.style.position="absolute",n.wrapper.style.left=p+"px",n.wrapper.style.top=u+"px"),!0)},dragMove:function(t,e){var i=this,n=t,o=e,r=g.body.offsetWidth,a=g.body.offsetHeight,l=r-i.dragContentWidth,d=a-i.dragContentHeight;(n-=i.dragDistX)<0&&(n=0),(o-=i.dragDistY)<0&&(o=0),l<n&&(n=l),d<o&&(o=d),i.wrapper.style.left=n+"px",i.wrapper.style.top=o+"px"},dragEnd:function(){},getFrame:function(t){return o[t]},setPopupReturnValue:function(t,e,i){if(t){h.isPlainObject(t)&&(i=e);var n=this.srcWindow?this.srcWindow:o;v(n,t,e),!1!==i&&this.hide(),h.event.trigger({type:"afterAction",context:n},null,this.el)}},back:function(t,e,i,n){this.hide()},destroy:function(){var t=this;h.zIndexer.remove(t.id),t.srcWindow=null,t.wrapper=null,t.titleText=null,t.titleFnClose=null,t.content=null,t.el=null},_init:function(){var t=this;t.wrapper=h(t.el).children("div.wrapper:first")[0],t.titleText=h(t.el).find("div.text:first")[0],t.titleFnClose=h(t.el).find("div.close:first")[0],t.content=h(t.wrapper).children("div.content:first")[0],t.width&&(t.wrapper.style.width=t.width),t.height&&(t.content.style.height=t.height),h(t.titleFnClose).tap(function(){t.hide()})}}),!h.os.pad&&!t){var a,l,d,s=!1,p=null;h(g).mousedown(function(t){0!=t.button&&1!=t.button||n.length&&(s=!1,a=t.target,l=t.pageX,d=t.pageY,p=o.setTimeout(function(){var t=o[n[n.length-1]];t&&(s=t.dragStart(a,l,d)),s&&(g.body.style.cursor="move")},200))}),h(g).mousemove(function(t){if((0==t.button||1==t.button)&&n.length&&s){!0;var e=o[n[n.length-1]];e&&e.dragMove(t.pageX,t.pageY)}}),h(g).mouseup(function(t){0!=t.button&&1!=t.button||(a=l=d=null,p&&o.clearTimeout(p),s&&(s=!1,g.body&&(g.body.style.cursor="")))})}var u=function(t,e){var i,n;h.Frame&&h.isFunction(h.Frame)&&h.Frame.prototype._init&&h("iframe[x-wade-uicomponent=frame]",t).each(function(){i=h.attr(this,"id"),(n=o[i])&&n instanceof h.Frame&&(n.setAttribute("popupId",e),!0!==n.inited?setTimeout("window['"+i+"'].init()",1):setTimeout("window['"+i+"'].adjust();window['"+i+"'].focus();",1))})},c=function(t){var e,i;h.Scroller&&h.isFunction(h.Scroller)&&h.Scroller.prototype._init&&h("div[x-wade-uicomponent=scroller]",t).each(function(){e=h.attr(this,"id"),(i=o[e])&&i instanceof h.Scroller&&setTimeout("window['"+e+"'].refresh()",1)})},f=function(t){var e,i;h.Table&&h.isFunction(h.Table)&&h.Table.prototype._init&&h("div[x-wade-uicomponent=table]",t).each(function(){e=h.attr(this,"id"),(i=o[e])&&i instanceof h.Table&&setTimeout("window['"+e+"'].adjust()",1)})},v=function(t,e,i){if(t&&t.Wade&&t.$)if(h.isString(e))t.$("#"+e).val(i);else if(h.isPlainObject(e))for(var n in e)t.$("#"+n).val(e[n]);else if(h.isArray(e)&&e.length&&e.length%2==0)for(var o=0;o<e.length;o+=2){n=e[o];var r=e[o+1];n&&"undefined"!=n&&t.$("#"+n).val(r)}};o.Dialog=h.Dialog=r}}(window.Wade,window,document);