/*!
 * increasereduce component
 * http://www.wadecn.com/
 * auth:xiedx@asiainfo.com
 * Copyright 2015, WADE
 */
!function(i,u,l){"use strict";if(i&&"undefined"==typeof i.IncreaseReduce){var e=l.createElement("input"),n="oninput"in e;e=null;var t,a="undefined"!=typeof i.hasTouch?i.hasTouch:"ontouchstart"in u,d=a?"touchend":"mouseup",s=a?"touchcancel":"mouseup",r=function(e,n){var a=this;a.el=e&&1==e.nodeType?e:l.getElementById(e),a.el&&a.el.nodeType&&(a.id=i.attr(a.el,"id"))&&(n&&i.isObject(n)&&i.extend(a,n),i.attr(a.el,"x-wade-uicomponent")||i.attr(a.el,"x-wade-uicomponent","increasereduce"),a._init(),a.constructor.call(a))};r.prototype=i.extend(new i.UIComponent,{val:function(e){var n=this;if(!i.isNumeric(e))return typeof n.value!=undefined&&null!=n.value?""+n.value:"";e=parseInt(e),n.min!=undefined&&e<n.min||n.max!=undefined&&e>n.max||(n.value=e,n.el.value=e)},getDisabled:function(){return this.disabled},setDisabled:function(e){var n=this;n.disabled=!!e;var a=n.spanEl.className?n.spanEl.className:"";n.disabled?((" "+a+" ").indexOf(" e_dis ")<0&&(n.spanEl.className=i.trim(a+" e_dis")),n.el.disabled=!0):(a=i.trim((" "+a+" ").replace(/ e_dis /gi," ")),n.spanEl.className=a,n.el.disabled=!1)},destroy:function(){var e=this;e.spanEl=null,e.btnReduce=null,e.btnIncrease=null,e.el=null},_init:function(){var a=this;a.spanEl=i(a.el).parents("span.e_group:first")[0],a.btnReduce=i(a.spanEl).find("span.e_ico-reduce:first")[0],a.btnIncrease=i(a.spanEl).find("span.e_ico-add:first")[0],/^[0-9]+/gi.test(a.el.value)?a.el.value=a.value=parseInt(a.el.value):a.el.value=a.value=0,a.disabled&&a.setDisabled(!0),i(a.btnReduce).tap(function(){if(a.disabled)return!1;a._reduce()}),i(a.btnIncrease).tap(function(){if(a.disabled)return!1;a._increase()}),i(a.btnReduce).longTap(function(){if(a.disabled)return!1;t||a.increaseReduceInterval||(a.increaseReduceInterval=u.setInterval(function(){a._reduce()},500),t=a.id)}),i(a.btnIncrease).longTap(function(){if(a.disabled)return!1;t||a.increaseReduceInterval||(a.increaseReduceInterval=u.setInterval(function(){a._increase()},500),t=a.id)}),n?i(a.el).bind("input",function(e){var n;if(this.value=(""+this.value).replace(/[^0-9]+/gi,""),""!=this.value){if(n=parseInt(this.value),a.min!=undefined&&n<a.min||a.max!=undefined&&n>a.max)return void(this.value=a.value);this.value=n}n!=undefined&&(a.value=n)}):(i(a.el).bind("keydown",function(e){return!a.disabled&&(!(e.shiftKey||e.altKey||e.ctrlKey)&&(47<e.keyCode&&e.keyCode<58||95<e.keyCode&&e.keyCode<106||8==e.keyCode||46==e.keyCode))}),i(a.el).bind("keyup",function(e){if(a.disabled)return!1;var n;if(""!=this.value){if(n=parseInt(this.value),a.min!=undefined&&n<a.min||a.max!=undefined&&n>a.max)return void(this.value=a.value);this.value=n}n!=undefined&&(a.value=n)}))},_increase:function(){var e,n=this,a=n.value;if(i.isNumber(n.value)&&-1<n.value){if(e=n.value+n.step,n.max!=undefined&&e>n.max)return;n.value=e}e!=undefined&&(n.el.value=e),!1===i.event.trigger("change",null,n.el)&&(n.el.value=n.value=a)},_reduce:function(){var e,n=this,a=n.value;if(i.isNumber(n.value)&&0<n.value){if(e=n.value-n.step,n.min!=undefined&&e<n.min)return;n.value=e}e!=undefined&&(n.el.value=e),!1===i.event.trigger("change",null,n.el)&&(n.el.value=n.value=a)}}),i(function(){i(l.body).bind(d,c),a&&i(l.body).bind(s,c)}),u.IncreaseReduce=i.IncreaseReduce=r}function c(e){var n;t&&(n=u[t])&&(u.clearInterval(n.increaseReduceInterval),n.increaseReduceInterval=null),t=null}}(window.Wade,window,document);