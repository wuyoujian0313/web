/*
 Copyright (c) 2003-2016, CKSource - Frederico Knabben. All rights reserved.
 For licensing, see LICENSE.md or http://ckeditor.com/license
*/
!function(){function b(e){e=e.toUpperCase();for(var t=s.length,l=0,n=0;n<t;++n)for(var i=s[n],r=i[1].length;e.substr(0,r)==i[1];e=e.substr(r))l+=i[0];return l}function v(e){e=e.toUpperCase();for(var t=1,l=1;0<e.length;l*=26)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(e.charAt(e.length-1))*l,e=e.substr(0,e.length-1);return t}var e=CKEDITOR.htmlParser.fragment.prototype,t=CKEDITOR.htmlParser.element.prototype;e.onlyChild=t.onlyChild=function(){var e=this.children;return 1==e.length&&e[0]||null},t.removeAnyChildWithName=function(e){for(var t,l=this.children,n=[],i=0;i<l.length;i++)(t=l[i]).name&&(t.name==e&&(n.push(t),l.splice(i--,1)),n=n.concat(t.removeAnyChildWithName(e)));return n},t.getAncestor=function(e){for(var t=this.parent;t&&(!t.name||!t.name.match(e));)t=t.parent;return t},e.firstChild=t.firstChild=function(e){for(var t,l=0;l<this.children.length;l++)if(e(t=this.children[l])||t.name&&(t=t.firstChild(e)))return t;return null},t.addStyle=function(e,t,l){var n="";if("string"==typeof t)n+=e+":"+t+";";else{if("object"==typeof e)for(var i in e)e.hasOwnProperty(i)&&(n+=i+":"+e[i]+";");else n+=e;l=t}this.attributes||(this.attributes={}),e=this.attributes.style||"",e=(l?[n,e]:[e,n]).join(";"),this.attributes.style=e.replace(/^;+|;(?=;)/g,"")},t.getStyle=function(e){var t=this.attributes.style;if(t)return(t=CKEDITOR.tools.parseCssText(t,1))[e]},CKEDITOR.dtd.parentOf=function(e){var t,l={};for(t in this)-1==t.indexOf("$")&&this[t][e]&&(l[t]=1);return l};var C,i,O=/^(?:\b0[^\s]*\s*){1,4}$/,I={ol:{decimal:/\d+/,"lower-roman":/^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/,"upper-roman":/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,"lower-alpha":/^[a-z]+$/,"upper-alpha":/^[A-Z]+$/},ul:{disc:/[l\u00B7\u2002]/,circle:/[\u006F\u00D8]/,square:/[\u006E\u25C6]/}},s=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],D=0,T=null,f=CKEDITOR.plugins.pastefromword={utils:{createListBulletMarker:function(e,t){var l=new CKEDITOR.htmlParser.element("cke:listbullet");return l.attributes={"cke:listsymbol":e[0]},l.add(new CKEDITOR.htmlParser.text(t)),l},isListBulletIndicator:function(e){if(/mso-list\s*:\s*Ignore/i.test(e.attributes&&e.attributes.style))return!0},isContainingOnlySpaces:function(e){var t;return(t=e.onlyChild())&&/^(:?\s|&nbsp;)+$/.test(t.value)},resolveList:function(e){var t,l=e.attributes;return(t=e.removeAnyChildWithName("cke:listbullet"))&&t.length&&(t=t[0])?(e.name="cke:li",l.style&&(l.style=f.filters.stylesFilter([["text-indent"],["line-height"],[/^margin(:?-left)?$/,null,function(e){e=e.split(" "),e=CKEDITOR.tools.convertToPx(e[3]||e[1]||e[0]),!D&&null!==T&&T<e&&(D=e-T),T=e,l["cke:indent"]=D&&Math.ceil(e/D)+1||1}],[/^mso-list$/,null,function(e){if(!((e=e.split(" ")).length<2)){var t=Number(e[0].match(/\d+/));1==(e=Number(e[1].match(/\d+/)))&&(t!==C&&(l["cke:reset"]=1),C=t),l["cke:indent"]=e}}]])(l.style,e)||""),l["cke:indent"]||(T=0,l["cke:indent"]=1),CKEDITOR.tools.extend(l,t.attributes),!0):(C=T=D=null,!1)},getStyleComponents:(i=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;"></div>',CKEDITOR.document),CKEDITOR.document.getBody().append(i),function(e,t,l){i.setStyle(e,t),e={},t=l.length;for(var n=0;n<t;n++)e[l[n]]=i.getStyle(l[n]);return e}),listDtdParents:CKEDITOR.dtd.parentOf("ol")},filters:{flattenList:function(e,t){t="number"==typeof t?t:1;var l,n=e.attributes;switch(n.type){case"a":l="lower-alpha";break;case"1":l="decimal"}for(var i,r=e.children,s=0;s<r.length;s++)if((i=r[s]).name in CKEDITOR.dtd.$listItem){var a=i.attributes,o=i.children,u=o[0],c=o[o.length-1];u.attributes&&u.attributes.style&&-1<u.attributes.style.indexOf("mso-list")&&(i.attributes.style=u.attributes.style,u.replaceWithChildren()),c.name in CKEDITOR.dtd.$list&&(e.add(c,s+1),--o.length||r.splice(s--,1)),i.name="cke:li",n.start&&!s&&(a.value=n.start),f.filters.stylesFilter([["tab-stops",null,function(e){(e=e.match(/0$|\d+\.?\d*\w+/))&&(T=CKEDITOR.tools.convertToPx(e[0]))}],1==t?["mso-list",null,function(e){e=e.split(" "),(e=Number(e[0].match(/\d+/)))!==C&&(a["cke:reset"]=1),C=e}]:null])(a.style),a["cke:indent"]=t,a["cke:listtype"]=e.name,a["cke:list-style-type"]=l}else if(i.name in CKEDITOR.dtd.$list){for(arguments.callee.apply(this,[i,t+1]),r=r.slice(0,s).concat(i.children).concat(r.slice(s+1)),e.children=[],i=0,o=r.length;i<o;i++)e.add(r[i]);r=e.children}delete e.name,n["cke:list"]=1},assembleList:function(e){var t,l,n,i,r,s,a=e.children;e=[];for(var o,u,c,f,d,m,h=0;h<a.length;h++)if("cke:li"==(t=a[h]).name)if(t.name="li",c=(c=(l=t.attributes)["cke:listsymbol"])&&c.match(/^(?:[(]?)([^\s]+?)([.)]?)$/),f=d=m=null,l["cke:ignored"])a.splice(h--,1);else{if(l["cke:reset"]&&(s=i=r=null),(n=Number(l["cke:indent"]))!=i&&(u=o=null),c){if(u&&I[u][o].test(c[1]))f=u,d=o;else for(var p in I)for(var y in I[p])if(I[p][y].test(c[1])){if("ol"!=p||!/alpha|roman/.test(y)){f=p,d=y;break}o=/roman/.test(y)?b(c[1]):v(c[1]),(!m||o<m)&&(m=o,f=p,d=y)}!f&&(f=c[2]?"ol":"ul")}else f=l["cke:listtype"]||"ol",d=l["cke:list-style-type"];if(u=f,o=d||("ol"==f?"decimal":"disc"),d&&d!=("ol"==f?"decimal":"disc")&&t.addStyle("list-style-type",d),"ol"==f&&c){switch(d){case"decimal":m=Number(c[1]);break;case"lower-roman":case"upper-roman":m=b(c[1]);break;case"lower-alpha":case"upper-alpha":m=v(c[1])}t.attributes.value=m}if(s){if(i<n)e.push(s=new CKEDITOR.htmlParser.element(f)),s.add(t),r.add(s);else{if(n<i){i-=n;for(var g;i--&&(g=s.parent);)s=g.parent}s.add(t)}a.splice(h--,1)}else e.push(s=new CKEDITOR.htmlParser.element(f)),s.add(t),a[h]=s;r=t,i=n}else s&&(s=i=r=null);for(h=0;h<e.length;h++)if(p=(s=e[h]).children,o=o=void 0,y=s.children.length,g=o=void 0,a=/list-style-type:(.*?)(?:;|$)/,i=CKEDITOR.plugins.pastefromword.filters.stylesFilter,o=s.attributes,!a.exec(o.style)){for(r=0;r<y;r++)if((o=p[r]).attributes.value&&Number(o.attributes.value)==r+1&&delete o.attributes.value,o=a.exec(o.attributes.style)){if(o[1]!=g&&g){g=null;break}g=o[1]}if(g){for(r=0;r<y;r++)(o=p[r].attributes).style&&(o.style=i([["list-style-type"]])(o.style)||"");s.addStyle("list-style-type",g)}}C=T=D=null},falsyFilter:function(){return!1},stylesFilter:function(u,c){return function(e,a){var o=[];(e||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(e,t,l){"font-family"==(t=t.toLowerCase())&&(l=l.replace(/["']/g,""));for(var n,i,r,s=0;s<u.length;s++)if(u[s]&&(e=u[s][0],n=u[s][1],i=u[s][2],r=u[s][3],t.match(e)&&(!n||l.match(n))))return t=r||t,c&&(i=i||l),"function"==typeof i&&(i=i(l,a,t)),i&&i.push&&(t=i[0],i=i[1]),void("string"==typeof i&&o.push([t,i]));!c&&o.push([t,l])});for(var t=0;t<o.length;t++)o[t]=o[t].join(":");return!!o.length&&o.join(";")+";"}},elementMigrateFilter:function(l,n){return l?function(e){var t=n?new CKEDITOR.style(l,n)._.definition:l;e.name=t.element,CKEDITOR.tools.extend(e.attributes,CKEDITOR.tools.clone(t.attributes)),e.addStyle(CKEDITOR.style.getStyleText(t)),t.attributes&&t.attributes["class"]&&(e.classWhiteList=" "+t.attributes["class"]+" ")}:function(){}},styleMigrateFilter:function(i,r){var s=this.elementMigrateFilter;return i?function(e,t){var l=new CKEDITOR.htmlParser.element(null),n={};n[r]=e,s(i,n)(l),l.children=t.children,t.children=[l],l.filter=function(){},l.parent=t}:function(){}},bogusAttrFilter:function(e,t){if(-1==t.name.indexOf("cke:"))return!1},applyStyleFilter:null},getRules:function(e,i){var n=CKEDITOR.dtd,r=CKEDITOR.tools.extend({},n.$block,n.$listItem,n.$tableContent),s=e.config,l=this.filters,t=l.falsyFilter,a=l.stylesFilter,o=l.elementMigrateFilter,u=CKEDITOR.tools.bind(this.filters.styleMigrateFilter,this.filters),c=this.utils.createListBulletMarker,f=l.flattenList,d=l.assembleList,m=this.utils.isListBulletIndicator,h=this.utils.isContainingOnlySpaces,p=this.utils.resolveList,y=function(e){return e=CKEDITOR.tools.convertToPx(e),isNaN(e)?e:e+"px"},g=this.utils.getStyleComponents,b=this.utils.listDtdParents,v=!1!==s.pasteFromWordRemoveFontStyles,C=!1!==s.pasteFromWordRemoveStyles;return{elementNames:[[/meta|link|script/,""]],root:function(e){e.filterChildren(i),d(e)},elements:{"^":function(e){var t;CKEDITOR.env.gecko&&(t=l.applyStyleFilter)&&t(e)},$:function(e){var t=e.name||"",l=e.attributes;if(t in r&&l.style&&(l.style=a([[/^(:?width|height)$/,null,y]])(l.style)||""),t.match(/h\d/)){if(e.filterChildren(i),p(e))return;o(s["format_"+t])(e)}else if(t in n.$inline)e.filterChildren(i),h(e)&&delete e.name;else if(-1!=t.indexOf(":")&&-1==t.indexOf("cke")){if(e.filterChildren(i),"v:imagedata"==t)return(t=e.attributes["o:href"])&&(e.attributes.src=t),void(e.name="img");delete e.name}t in b&&(e.filterChildren(i),d(e))},style:function(e){if(CKEDITOR.env.gecko){e=(e=e.onlyChild().value.match(/\/\* Style Definitions \*\/([\s\S]*?)\/\*/))&&e[1];var i={};e&&(e.replace(/[\n\r]/g,"").replace(/(.+?)\{(.+?)\}/g,function(e,t,n){e=(t=t.split(",")).length;for(var l=0;l<e;l++)CKEDITOR.tools.trim(t[l]).replace(/^(\w+)(\.[\w-]+)?$/g,function(e,t,l){t=t||"*",(l=l.substring(1,l.length)).match(/MsoNormal/)||(i[t]||(i[t]={}),l?i[t][l]=n:i[t]=n)})}),l.applyStyleFilter=function(e){var t=i["*"]?"*":e.name,l=e.attributes&&e.attributes["class"];t in i&&("object"==typeof(t=i[t])&&(t=t[l]),t&&e.addStyle(t,!0))})}return!1},p:function(e){if(/MsoListParagraph/i.exec(e.attributes["class"])||e.getStyle("mso-list")&&!e.getStyle("mso-list").match(/^(none|skip)$/i)){var t=e.firstChild(function(e){return e.type==CKEDITOR.NODE_TEXT&&!h(e.parent)});(t=t&&t.parent)&&t.addStyle("mso-list","Ignore")}e.filterChildren(i),p(e)||(s.enterMode==CKEDITOR.ENTER_BR?(delete e.name,e.add(new CKEDITOR.htmlParser.element("br"))):o(s["format_"+(s.enterMode==CKEDITOR.ENTER_P?"p":"div")])(e))},div:function(e){var t=e.onlyChild();if(t&&"table"==t.name){var l=e.attributes;t.attributes=CKEDITOR.tools.extend(t.attributes,l),l.style&&t.addStyle(l.style),(t=new CKEDITOR.htmlParser.element("div")).addStyle("clear","both"),e.add(t),delete e.name}},td:function(e){e.getAncestor("thead")&&(e.name="th")},ol:f,ul:f,dl:f,font:function(e){if(m(e.parent))delete e.name;else{e.filterChildren(i);var t=e.attributes,l=t.style,n=e.parent;"font"==n.name?(CKEDITOR.tools.extend(n.attributes,e.attributes),l&&n.addStyle(l),delete e.name):(l=(l||"").split(";"),t.color&&("#000000"!=t.color&&l.push("color:"+t.color),delete t.color),t.face&&(l.push("font-family:"+t.face),delete t.face),t.size&&(l.push("font-size:"+(3<t.size?"large":t.size<3?"small":"medium")),delete t.size),e.name="span",e.addStyle(l.join(";")))}},span:function(e){if(m(e.parent))return!1;if(e.filterChildren(i),h(e))return delete e.name,null;if(m(e)){var t=e.firstChild(function(e){return e.value||"img"==e.name}),l=(t=t&&(t.value||"l."))&&t.match(/^(?:[(]?)([^\s]+?)([.)]?)$/);if(l)return t=c(l,t),(e=e.getAncestor("span"))&&/ mso-hide:\s*all|display:\s*none /.test(e.attributes.style)&&(t.attributes["cke:ignored"]=1),t}return(l=(t=e.attributes)&&t.style)&&(t.style=a([["line-height"],[/^font-family$/,null,v?null:u(s.font_style,"family")],[/^font-size$/,null,v?null:u(s.fontSize_style,"size")],[/^color$/,null,v?null:u(s.colorButton_foreStyle,"color")],[/^background-color$/,null,v?null:u(s.colorButton_backStyle,"color")]])(l,e)||""),t.style||delete t.style,CKEDITOR.tools.isEmpty(t)&&delete e.name,null},b:o(s.coreStyles_bold),i:o(s.coreStyles_italic),u:o(s.coreStyles_underline),s:o(s.coreStyles_strike),sup:o(s.coreStyles_superscript),sub:o(s.coreStyles_subscript),a:function(e){var t=e.attributes;t.name&&t.name.match(/ole_link\d+/i)?delete e.name:t.href&&t.href.match(/^file:\/\/\/[\S]+#/i)&&(t.href=t.href.replace(/^file:\/\/\/[^#]+/i,""))},"cke:listbullet":function(e){e.getAncestor(/h\d/)&&!s.pasteFromWordNumberedHeadingToList&&delete e.name}},attributeNames:[[/^onmouse(:?out|over)/,""],[/^onload$/,""],[/(?:v|o):\w+/,""],[/^lang/,""]],attributes:{style:a(C?[[/^list-style-type$/,null],[/^margin$|^margin-(?!bottom|top)/,null,function(e,t,l){if(t.name in{p:1,div:1}){if(t="ltr"==s.contentsLangDirection?"margin-left":"margin-right","margin"==l)e=g(l,e,[t])[t];else if(l!=t)return null;if(e&&!O.test(e))return[t,e]}return null}],[/^clear$/],[/^border.*|margin.*|vertical-align|float$/,null,function(e,t){if("img"==t.name)return e}],[/^width|height$/,null,function(e,t){if(t.name in{table:1,td:1,th:1,img:1})return e}]]:[[/^mso-/],[/-color$/,null,function(e){return"transparent"!=e&&(CKEDITOR.env.gecko?e.replace(/-moz-use-text-color/g,"transparent"):void 0)}],[/^margin$/,O],["text-indent","0cm"],["page-break-before"],["tab-stops"],["display","none"],v?[/font-?/]:null],C),width:function(e,t){if(t.name in n.$tableContent)return!1},border:function(e,t){if(t.name in n.$tableContent)return!1},"class":function(e,t){return!(!t.classWhiteList||-1==t.classWhiteList.indexOf(" "+e+" "))&&e},bgcolor:t,valign:C?t:function(e,t){return t.addStyle("vertical-align",e),!1}},comment:CKEDITOR.env.ie?t:function(e,t){var l=e.match(/<img.*?>/),n=e.match(/^\[if !supportLists\]([\s\S]*?)\[endif\]$/);return n?(n=(l=n[1]||l&&"l.")&&l.match(/>(?:[(]?)([^\s]+?)([.)]?)</),c(n,l)):!(!CKEDITOR.env.gecko||!l)&&(l=CKEDITOR.htmlParser.fragment.fromHtml(l[0]).children[0],(n=(n=(n=t.previous)&&n.value.match(/<v:imagedata[^>]*o:href=['"](.*?)['"]/))&&n[1])&&(l.attributes.src=n),l)}}}},r=function(){this.dataFilter=new CKEDITOR.htmlParser.filter};r.prototype={toHtml:function(e){e=CKEDITOR.htmlParser.fragment.fromHtml(e);var t=new CKEDITOR.htmlParser.basicWriter;return e.writeHtml(t,this.dataFilter),t.getHtml(!0)}},CKEDITOR.cleanWord=function(e,t){e=e.replace(/<!\[([^\]]*?)\]>/g,"\x3c!--[$1]--\x3e"),CKEDITOR.env.gecko&&(e=e.replace(/(\x3c!--\[if[^<]*?\])--\x3e([\S\s]*?)\x3c!--(\[endif\]--\x3e)/gi,"$1$2$3")),CKEDITOR.env.webkit&&(e=e.replace(/(class="MsoListParagraph[^>]+>\x3c!--\[if !supportLists\]--\x3e)([^<]+<span[^<]+<\/span>)(\x3c!--\[endif\]--\x3e)/gi,"$1<span>$2</span>$3"));var l=new r,n=l.dataFilter;n.addRules(CKEDITOR.plugins.pastefromword.getRules(t,n)),t.fire("beforeCleanWord",{filter:n});try{e=l.toHtml(e)}catch(i){t.showNotification(t.lang.pastefromword.error)}return(e=(e=e.replace(/cke:.*?".*?"/g,"")).replace(/style=""/g,"")).replace(/<span>/g,"")}}();