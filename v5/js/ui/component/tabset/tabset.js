/*!
 * tabset component
 * http://www.wadecn.com/
 * auth:xiedx@asiainfo.com
 * Copyright 2015, WADE
 */
!function(f,m,p){"use strict";if(f&&"undefined"==typeof f.Tabset){var n=Array.prototype.splice,c=Math,a=p.createElement("div").style,e=function(){for(var t="t,webkitT,MozT,msT,OT".split(","),e=0,i=t.length;e<i;e++)if(t[e]+"ransform"in a)return t[e].substr(0,t[e].length-1);return!1}(),b=e?"-"+e.toLowerCase()+"-":"",v=R("transform"),h=R("transitionProperty"),_=R("transitionDuration"),g=R("transformOrigin"),T=R("transitionTimingFunction"),t=(R("transitionDelay"),R("perspective")in a),x="undefined"!=typeof f.hasTouch?f.hasTouch:"ontouchstart"in m,i=!1!==e,s=R("transition")in a,r="onorientationchange"in m?"orientationchange":"resize",o=x?"touchstart":"mousedown",l=x?"touchmove":"mousemove",d=x?"touchend":"mouseup",u=x?"touchcancel":"mouseup",y=function(){if(!1===e)return!1;return{"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"otransitionend",ms:"MSTransitionEnd"}[e]}(),w=m.requestAnimationFrame||m.webkitRequestAnimationFrame||m.mozRequestAnimationFrame||m.oRequestAnimationFrame||m.msRequestAnimationFrame||function(t){return setTimeout(t,1)},S=m.cancelRequestAnimationFrame||m.webkitCancelAnimationFrame||m.webkitCancelRequestAnimationFrame||m.mozCancelRequestAnimationFrame||m.oCancelRequestAnimationFrame||m.msCancelRequestAnimationFrame||clearTimeout,I=t?" translateZ(0)":"",X=f.os.phone||!0===f.ratioPhone,N=1e5,F=null,L=function(t,e){var i=this;i.el=t&&1==t.nodeType?t:p.getElementById(t),i.el&&i.el.nodeType&&f.nodeName(i.el,"div")&&(i.id=f.attr(i.el,"id"))&&(e&&f.isObject(e)&&f.extend(i,e),f.attr(i.el,"x-wade-uicomponent")||f.attr(i.el,"x-wade-uicomponent","tabset"),i._init(),i.constructor.call(i))};L.prototype=f.extend(new f.UIComponent,{handleEvent:function(t){var e=this;switch(t.type){case o:if(!x&&0!==t.button)return;e._start(t);break;case l:e._move(t);break;case d:case u:e._end(t);break;case r:e._resize();break;case y:e._transitionEnd(t)}},updateTitle:function(t){t&&f.isString(t)&&f("#"+this.id+"_tab_title_text").text(t)},updateTitleTip:function(t){t!=undefined&&null!=t&&f("#"+this.id+"_tab_title_tip_tag").text(t)},add:function(t,e){var i=this;if(!t||!f.isString(t))return-1;if(!e||!f.isPlainObject(e))return-1;if(20<=i.contents.length)return-1;t=f.xss(t);var n=f.extend({},e),a=n.html&&f.isString(n.html),s=n.page&&f.isString(n.page)||n.src&&f.isString(n.src);if(!a&&!s)return-1;var r=i.contents.length,o=i.id+"_"+r;f(i.tabUl).append('<li id="'+i.id+"_tab_li_"+r+'" idx="'+r+'">'+t+"</li>");var l=[];l.push('\r\n<div title="'+t+'" class="content" idx="'+r+'" style="'+(i.width?"width:"+i.width+"px":"")+'">'),a?l.push(n.html):s&&(l.push('<iframe id="frame_'+o+'" style="width:100%;height:100%;display:none" frameborder="0"></iframe>'),l.push('<div class="c_msg c_msg-full c_msg-loading">'),l.push('<div class="wrapper">'),l.push('<div class="emote"></div>'),l.push('<div class="info"><div class="text"><div class="title">loading</div></div></div>'),l.push("</div>"),l.push("</div>")),l.push("\r\n</div>"),f(i.page).append(l.join("")),l=null;var d=f(i.page).children("div[idx="+r+"]");d&&d.length&&(i.titles[r]=t,i.contents.push(d[0]),i.frameSize++),d=null;var c=i.el.className?i.el.className:"";return c=f.trim((" "+c+" ").replace(/ c_tab-slide-\d+ /g," "))+" c_tab-slide-"+(r+1),i.el.className=c,s&&(f.Frame||m.includeScript(f.UI_FRAME_JS,!0,!0),m["frame_"+o]=new Wade.Frame("frame_"+o,{autoInit:!1,title:t,page:n.page,listener:n.listener,params:n.params,subsys:n.subsys,src:n.src})),r},remove:function(t){if(!t||!f.isString(t))return-1;this._findIdxByTitle(t)},switchTo:function(t,e,i){var n=this;if(/^\d+$/.test(t)&&n.activeIdx!=t){var a,s;if(t=parseInt(t),(a=n.contents[t])&&a.nodeType){if(!0!==i)if(!1===n.slidable||n.vertical){if(typeof n.activeIdx!=undefined){var r=n.contents[n.activeIdx];r&&r.nodeType&&(r.style.display="none")}a.style.display=""}else{var o=c.abs(t*n.width);n.useTouchSwitch?n.scrollTo(0-o,0,0):n.page.style.left=0-o+"px"}setTimeout(function(){E(a,n.id),z(a),D(a)},e||0)}if((s=p.getElementById(n.id+"_tab_li_"+n.activeIdx))&&s.nodeType&&(s.className=""),(s=p.getElementById(n.id+"_tab_li_"+t))&&s.nodeType&&(s.className="on",n.tabScroller)){var l=0-s.offsetLeft;l=c.max(l,n.tabScroller.maxScrollX),n.tabScroller.scrollTo(l,0,200)}s=null,n.activeIdx=t,setTimeout(function(){f.event.trigger("afterSwitchAction",t,n.el)},e||0)}},switchToByTitle:function(t){this.switchTo(this._findIdxByTitle(t))},privFrame:function(){var t=this,e=0,i=t.activeIdx-1;if(i<0||i>t.frameSize-1){var n=A(t.el);return n&&0<n.activeIdx?n.privFrame():void 0}if(t.useTouchSwitch){var a=i*t.width;e=c.abs(c.round(t.width/2));t.scrollTo(0-c.abs(a),0,e)}return t.switchTo(i,e,!!e),!0},nextFrame:function(){var t=this,e=t.activeIdx+1;if(e<0||e>t.frameSize-1){var i=A(t.el);return i&&i.activeIdx<i.frameSize-1?i.nextFrame():void 0}if(t.useTouchSwitch){var n=e*t.width,a=c.abs(c.round(t.width/2));t.scrollTo(0-c.abs(n),0,a)}return t.switchTo(e,a,!!a),!0},adjust:function(t){var e=this;if(!e.vertical){if(!1!==e.slidable){if(e.width=e.el.offsetWidth,e.contents&&e.contents.length)for(var i=0;i<e.contents.length;i++)e.contents[i].style.width=e.width+"px";if(1==t&&-1<e.activeIdx){var n=c.abs(e.activeIdx*e.width);e.useTouchSwitch?e.scrollTo(0-n,0,0):e.page.style.left=0-n+"px"}}var a=0;f(e.tab).children("div.fn").each(function(){a+=this.offsetWidth}),e.tabUlWidth=f(e.tabUl).width(),f("#"+e.id+"_move_fn").css("display",e.width-a<e.tabUlWidth?"":"none")}},destroy:function(){var t=this;for(var e in m.clearInterval(t.tabLeftInterval),t.tabLeftInterval=null,m.clearInterval(t.tabRightInterval),t.tabRightInterval=null,F=null,t.titles)delete t.titles[e];t.titles=null;for(var i=0;i<t.contents.length;i++)n.call(t.contents,i--,1);t.contents=null,t.tabScroller&&t.tabScroller.destroy(),t.page.style[v]="",t._unbind(r,m),t._unbind(o),t._unbind(l,p),t._unbind(d,p),t._unbind(u,p),t.tab=null,t.tabList=null,t.tabUl=null,t.page=null,t.el=null},_init:function(){var u=this;u.tab=f(u.el).children("div.tab:first")[0],u.tabList=f(u.tab).children("div.list:first")[0],u.tabUl=f(u.tabList).children("ul:first")[0],u.page=f(u.el).children("div.page:first")[0];var t=u.el.className?u.el.className:"";u.vertical=-1<(" "+t+" ").indexOf(" c_tab-v "),u.scale=1,u.useTransform=i,u.useTransition=s,u.x=0,u.y=0,u.aniTime=null,u.frameSize=0,u.useTouchSwitch=!u.vertical&&!1!==u.slidable&&(x||X),u.titles={},u.contents=[],u.activeIdx=-1,setTimeout(function(){var t,e,i,n,a,s,r;u.useTouchSwitch&&(u.page.style[h]=u.useTransform?b+"transform":"top left",u.page.style[_]="0",u.page.style[g]="0 0",u.useTransition&&(u.page.style[T]="cubic-bezier(0.33,0.66,0.66,1)"),u.useTransform?u.page.style[v]="translate("+u.x+"px,"+u.y+"px)"+I:u.page.style.cssText+=";position:absolute;left:"+u.x+"px"),i=u.page.childNodes;var o=f(u.tabUl).children("li");if(i&&0<i.length)for(t=e=0;e<i.length;)(a=i[e])&&a.nodeType&&f.nodeName(a,"div")&&-1<(" "+a.className+" ").indexOf(" content ")&&(r!=undefined||"none"==a.style.display&&"true"!=f.attr(a,"default")||(r=t),!1===u.slidable||u.vertical?"none"!=a.style.display&&r!=t&&(a.style.display="none"):"none"==a.style.display&&(a.style.display=""),f.attr(a,"idx",t),u.contents.push(a),(n=f.attr(a,"title"))||(n=f.lang.get("ui.component.tabset.unamed.tab")+t),u.titles[t]=n,a.removeAttribute("title"),(s=o[t])?""==f.trim(s.innerHTML)&&(s.innerHTML=n):((s=document.createElement("li")).innerHTML=n,u.tabUl.appendChild(s)),f.attr(s,"id",u.id+"_tab_li_"+t),f.attr(s,"idx",t),t++),e++;if(o=null,u.frameSize=u.contents.length,!1!==u.slidable&&!u.vertical){var l=u.el.className?u.el.className:"";l=f.trim((" "+l+" ").replace(/ c_tab-slide-\d+ /g," "))+" c_tab-slide-"+t,u.el.className=l}if(a=r==undefined&&0<u.contents.length?(r=0,u.contents[0]):u.contents[r],f.isNumeric(r)&&(s=p.getElementById(u.id+"_tab_li_"+r))&&s.nodeType&&(s.className="on"),E(a),i=a=s=null,u.activeIdx=r,!x&&!X){var d=[];d.push('<div id="'+u.id+'_move_fn" class="fn ctrl">'),d.push('<button id="'+u.id+'_moveleft_btn" type="button" class="e_button-r e_button-blue"><span class="e_ico-back"></span></button>'),d.push('<button id="'+u.id+'_moveright_btn" type="button" class="e_button-r e_button-blue"><span class="e_ico-next"></span></button>'),d.push("</div>");var c=f(u.tab).children("div.fn:first");c&&c.length?c.before(d.join("")):f(u.tab).append(d.join("")),d=c=null}f(u.page).children("div.fn:first").appendTo(u.tab),u.adjust(),(x||X)&&(u.tabScroller=new f.Scroll(u.tabList,{bounce:!0,vScroll:u.vertical,hScrollbar:!1,vScrollbar:!1})),!1!==u.slidable&&!u.vertical&&f.isNumeric(r)&&(u.page.style.left=0-r*u.width+"px")},0),f(u.tabUl).tap(function(t){t.originalEvent&&(t=f.event.fix(t.originalEvent));var e=t.target;if(e&&e.nodeType){for(var i,n=0;n<5&&!f.nodeName(e,"li")&&(e=e.parentNode,!f.nodeName(e,"li"));)n++;if(f.nodeName(e,"li")&&0==(""+f.attr(e,"id")).indexOf(u.id)&&(i=f.attr(e,"idx"))){if(!1===f.event.trigger("switchAction",i,u.el))return!1;u.switchTo(i)}}});x||f(u.tab).mousedown(function(t){var e=t.target;if(e&&"1"==e.nodeType&&f.nodeName(e,"button")){var i=f.attr(e,"id");if(!i||!f.isString(i))return;var n=i.replace(/^[0-9a-zA-Z]+_move([a-zA-Z]+)_btn$/g,"$1");if(!n)return;if(u.tabUl.offsetWidth<u.tabList.offsetWidth)return;"left"==n&&(F||u.tabLeftInterval||(u.tabLeftInterval=m.setInterval(function(){var t=f(u.tabUl),e=t.css("left");e&&(e=parseInt(e)),!e||N<=e?(m.clearInterval(u.tabLeftInterval),u.tabLeftInterval=null,F=null):t.css("left",Math.min(e+5,N)+"px"),t=null},5),F=u.id)),"right"==n&&(F||u.tabRightInterval||(u.tabRightInterval=m.setInterval(function(){var t=u.tabUl.offsetWidth-u.tabList.offsetWidth,e=f(u.tabUl),i=e.css("left");i&&(i=parseInt(i)),!i||i<=N-t?(m.clearInterval(u.tabRightInterval),u.tabRightInterval=null,F=null):e.css("left",Math.max(i-5,N-t)+"px"),e=null},5),F=u.id))}}),p.addEventListener?u._bind(r,m):f(m).resize(function(){u._resize()}),u.useTouchSwitch&&u._bind(o)},_findIdxByTitle:function(t){if(t&&f.isString(t))for(var e in this.titles)if(this.titles[e]==t)return e},_bind:function(t,e,i){p.addEventListener&&(e||this.page).addEventListener(t,this,!!i)},_unbind:function(t,e,i){p.removeEventListener&&(e||this.page).removeEventListener(t,this,!!i)},_pos:function(t,e){var i=this;i.useTransform?i.page.style[v]="translate("+t+"px,"+e+"px) scale("+i.scale+")"+I:(t=c.round(t),e=c.round(e),this.page.style.left=t+"px",this.page.style.top=e+"px"),i.x=t,i.y=e},_start:function(t){var e=this,i=x?t.touches[0]:t,n=t.target;if(n){n="tagName"in n?n:n.parentNode;var a=A(n);if(!a||a!=e)return;if(1==n.nodeType&&n.nodeName&&(f.nodeName(n,"input")||f.nodeName(n,"select")||f.nodeName(n,"textarea")))return}e.useTransition&&e._transitionTime(0),e.moved=!1,e.animating=!1,e.distX=0,e.distY=0,e.absDistX=0,e.absDistY=0,e.dirX=0,e.dirY=0,e.absStartX=e.x,e.absStartY=e.y,e.startX=e.x,e.startY=e.y,e.pointX=i.pageX,e.pointY=i.pageY,e.startTime=t.timeStamp||Date.now(),e._bind(l,p),e._bind(d,p),e._bind(u,p)},_move:function(t){var e=this,i=x?t.touches[0]:t,n=i.pageX-e.pointX,a=i.pageY-e.pointY,s=e.x+n,r=(e.y,t.timeStamp||Date.now());if(e.pointX=i.pageX,e.pointY=i.pageY,e.distX+=n,e.distY+=a,e.absDistX=c.abs(e.distX),e.absDistY=c.abs(e.distY),!(e.absDistX<6&&e.absDistY<6)){e.moved=!0,e.dirX=0<n?-1:n<0?1:0,300<r-e.startTime&&(e.startTime=r,e.startX=e.x);var o=c.abs((e.frameSize-1)*e.width);if(0<s||s<0-o)s=e.x+n/2;else if(e.absDistX<e.absDistY)e.moved=!1;else{if(f.Scroll&&f.Scroll.parentWrapper){var l=f.Scroll.parentWrapper(t.target);if(l&&l.nodeType&&"true"==l.getAttribute("hScroll"))return void(e.moved=!1)}e._pos(s,0)}}},_end:function(t){var e=this;if(!x||0===t.touches.length){x&&t.changedTouches[0],t.timeStamp||Date.now(),e.startTime;var i,n=e.x;if(e._unbind(l,p),e._unbind(d,p),e._unbind(u,p),!(e.frameSize<=0))if(e.moved)if(c.abs(e.distX)<f.format.rem2px(.8))e._resetPos(200,!0);else if(i=n-e.absStartX,e.snapThreshold&&c.abs(i)<e.snapThreshold)e.scrollTo(e.absStartX,0,200);else{if(e.dirX<0){if(1==e.privFrame())return}else if(0<e.dirX&&1==e.nextFrame())return;e._resetPos(200)}else e._resetPos(400)}},_resize:function(){this.adjust(!0)},_transitionEnd:function(t){t.target==this.page&&(this._unbind(y),this._startAni())},_transitionTime:function(t){t+="ms",this.page.style[_]=t},_resetPos:function(t,e){var i=this,n=c.abs((i.frameSize-1)*i.width),a=0<=i.x?0:i.x<0-n?0-n:i.x;1==e&&-1<i.activeIdx&&(a=0-c.abs(i.activeIdx*i.width)),a!=i.x?i.scrollTo(a,0,t||0):i.moved&&(i.moved=!1)},scrollTo:function(t,e,i,n){var a,s,r=this,o=t;for(r.stop(),o.length||(o=[{x:t,y:e,time:i,relative:n}]),a=0,s=o.length;a<s;a++)o[a].relative&&(o[a].x=r.x-o[a].x,o[a].y=r.y-o[a].y),r.steps.push({x:o[a].x,y:o[a].y,time:o[a].time||0});r._startAni()},stop:function(){var t=this;t.useTransition?t._unbind(y):S(t.aniTime),t.steps=[],t.moved=!1,t.animating=!1},_startAni:function(){var n,a,s,r=this,o=r.x,l=r.y,d=Date.now();if(!r.animating)if(r.steps.length){if((n=r.steps.shift()).x==o&&n.y==l&&(n.time=0),r.animating=!0,r.moved=!0,r.useTransition)return r._transitionTime(n.time),r._pos(n.x,n.y),r.animating=!1,void(n.time?r._bind(y):r._resetPos(0));(s=function(){var t,e,i=Date.now();if(i>=d+n.time)return r._pos(n.x,n.y),r.animating=!1,void r._startAni();i=(i-d)/n.time-1,a=c.sqrt(1-i*i),t=(n.x-o)*a+o,e=(n.y-l)*a+l,r._pos(t,e),r.animating&&(r.aniTime=w(s))})()}else r._resetPos(400)}}),(L.FramePage=function(){var t=this;if(f.isSameDomain(parent)&&!f.isSamePage(parent)&&parent.Wade&&parent.Wade.Tabset){var e=f.getParentIframe();e&&e.nodeType&&(t.tabset=parent.Wade.Tabset.findParentTabset(e),t.tabset&&t.tabset.useTouchSwitch&&(t.x=0,t.y=0,t._bind(o)))}}).prototype={handleEvent:function(t){switch(t.type){case o:if(!x&&0!==t.button)return;this._start(t);break;case l:this._move(t);break;case d:case u:this._end(t)}},destroy:function(){this._unbind(o),this._unbind(l,p),this._unbind(d,p),this._unbind(u,p)},_bind:function(t,e,i){p.addEventListener&&(e||m).addEventListener(t,this,!!i)},_unbind:function(t,e,i){p.removeEventListener&&(e||m).removeEventListener(t,this,!!i)},_start:function(t){var e=this,i=x?t.touches[0]:t,n=t.target;n&&(n="tagName"in n?n:n.parentNode,e.targetTaset=A(n),e.targetTasetStartIdx=e.targetTaset&&e.targetTaset.activeIdx,1==n.nodeType&&n.nodeName&&(f.nodeName(n,"input")||f.nodeName(n,"select")||f.nodeName(n,"textarea")))||(e.moved=!1,e.distX=0,e.absDistX=0,e.dirX=0,e.absStartX=e.x,e.startX=e.x,e.pointX=i.pageX,e.startTime=t.timeStamp||Date.now(),e._bind(l,p),e._bind(d,p),e._bind(u,p))},_move:function(t){var e=this,i=x?t.touches[0]:t,n=i.pageX-e.pointX,a=t.timeStamp||Date.now();e.pointX=i.pageX;var s=e.tabset.x+e.distX;if(e.distX+=n,e.absDistX=c.abs(e.distX),!(e.absDistX<6)){var r=c.abs((e.tabset.frameSize-1)*e.tabset.width);(0<s||s<0-r)&&(s=e.tabset.x+e.distX/2),e.moved=!0,e.dirX=0<n?-1:n<0?1:0,300<a-e.startTime&&(e.startTime=a,e.startX=e.x)}},_end:function(t){var e=this;if(!(x&&0!==t.touches.length||(e._unbind(l,p),e._unbind(d,p),e._unbind(u,p),e.tabset.frameSize<=0)))if(e.moved)if(c.abs(e.distX)<f.format.rem2px(.8))e.tabset._resetPos(200,!0);else{if(e.dirX<0){if(e.targetTaset&&0<e.targetTasetStartIdx)return;if(1==e.tabset.privFrame())return}else if(0<e.dirX){if(e.targetTaset&&e.targetTasetStartIdx<e.targetTaset.frameSize-1)return;if(1==e.tabset.nextFrame())return}e.tabset._resetPos(200)}else e.tabset._resetPos(400)}};var A=function(t){if(t&&t.nodeType){for(var e,i,n=0,a=t.parentNode,s=!1;n<50&&a!=p.documentElement;){if(a&&a.nodeType&&f.nodeName(a,"div")&&"tabset"==f.attr(a,"x-wade-uicomponent")&&(e=f.attr(a,"id"))){s=!0;break}a=a.parentNode,n++}return s&&e&&(i=m[e])&&i instanceof L?i:void 0}},E=function(t,e){var i,n;f.Frame&&f.isFunction(f.Frame)&&f.Frame.prototype._init&&f("iframe[x-wade-uicomponent=frame]",t).each(function(){i=f.attr(this,"id"),(n=m[i])&&n instanceof f.Frame&&(n.setAttribute("tabsetId",e),!0!==n.inited?setTimeout("window['"+i+"'].init()",1):setTimeout("window['"+i+"'].adjust()",1))})},z=function(t){var e,i;f.Scroller&&f.isFunction(f.Scroller)&&f.Scroller.prototype._init&&f("div[x-wade-uicomponent=scroller]",t).each(function(){e=f.attr(this,"id"),(i=m[e])&&i instanceof f.Scroller&&setTimeout("window['"+e+"'].refresh()",1)})},D=function(t){var e,i;f.Table&&f.isFunction(f.Table)&&f.Table.prototype._init&&f("div[x-wade-uicomponent=table]",t).each(function(){e=f.attr(this,"id"),(i=m[e])&&i instanceof f.Table&&setTimeout("window['"+e+"'].adjust()",1)})};f.extend(L,{findParentTabset:function(t){return A(t)}}),x||f(function(){f(p.body).bind("mouseup",function(t){var e;F&&(e=m[F])&&(m.clearInterval(e.tabLeftInterval),e.tabLeftInterval=null,m.clearInterval(e.tabRightInterval),e.tabRightInterval=null),F=null})}),a=null,m.Tabset=f.Tabset=L}function R(t){return""===e?t:(t=t.charAt(0).toUpperCase()+t.substr(1),e+t)}}(window.Wade,window,document);